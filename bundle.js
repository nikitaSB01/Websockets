!function(){var e={25:function(){const e=new WebSocket("wss://websocketsserver.onrender.com");e.onopen=()=>{console.log("==> Connected to WebSocket server")},e.onclose=()=>{console.log("==> Disconnected from WebSocket server")},e.onmessage=e=>{const n=JSON.parse(e.data);console.log("==> Received:",n)},document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("nickname-modal"),n=document.getElementById("nickname-input"),t=document.getElementById("nickname-submit"),s=document.getElementById("clear-history");t.addEventListener("click",(()=>{const t=n.value.trim();t?async function(n){try{const t=await fetch("https://websocketsserver.onrender.com/new-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n})}),o=await t.json();"ok"===o.status?(console.log("==> Никнейм принят:",o.user.name),e.style.display="none",function(e){const n=document.getElementById("chat-container"),t=document.getElementById("message-input"),o=document.getElementById("send-message"),r=document.getElementById("messages"),a=document.getElementById("users");n.style.display="flex";const c=new WebSocket("wss://websocketsserver.onrender.com"),i=setInterval((()=>{c.readyState===WebSocket.OPEN&&c.send(JSON.stringify({type:"ping",user:{name:e}}))}),3e3);function d(){const n=t.value.trim();if(n){const s={type:"send",message:n,user:{name:e},timestamp:(new Date).toISOString()};c.send(JSON.stringify(s)),m({...s,user:{name:"You"}}),t.value=""}}function m(e){const n=document.createElement("div");n.className="You"===e.user.name?"my-message":"other-message";const t=document.createElement("div");t.className="message-meta";const s=new Date(e.timestamp||Date.now()),o=s.toLocaleDateString(),a=s.toLocaleTimeString();t.innerHTML=`<strong>${e.user.name}:</strong> <span class="timestamp">${o} ${a}</span>`;const c=document.createElement("div");c.className="message-text",c.textContent=e.message,n.appendChild(t),n.appendChild(c),r.appendChild(n),r.scrollTop=r.scrollHeight}function l(n){a.innerHTML="",n.forEach((n=>{const t=document.createElement("li");t.textContent=n.name===e?"You":n.name,n.name===e&&t.classList.add("current-user"),a.appendChild(t)}))}c.onopen=()=>{c.send(JSON.stringify({type:"join",user:{name:e}}))},c.onmessage=n=>{const t=JSON.parse(n.data);if(Array.isArray(t)){l(t.filter((e=>""!==e.name)))}else"send"===t.type?t.user.name!==e&&m(t):"history"===t.type&&(r.innerHTML="",t.data.forEach((e=>m(e))))},t.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),d())})),o.addEventListener("click",d),s.addEventListener("click",(()=>{c.send(JSON.stringify({type:"clear"})),r.innerHTML=""})),window.addEventListener("beforeunload",(()=>{c.send(JSON.stringify({type:"exit",user:{name:e}})),c.close(),clearInterval(i)})),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&(c.send(JSON.stringify({type:"exit",user:{name:e}})),c.close())}))}(n)):alert(o.message)}catch(e){console.error("Ошибка при проверке никнейма:",e)}}(t):alert("Пожалуйста, введите псевдоним.")}))}))}},n={};function t(s){var o=n[s];if(void 0!==o)return o.exports;var r=n[s]={exports:{}};return e[s](r,r.exports,t),r.exports}t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},t.d=function(e,n){for(var s in n)t.o(n,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:n[s]})},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){"use strict";t(25)}()}();
//# sourceMappingURL=bundle.js.map