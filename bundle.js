!function(){var e={25:function(){const e=new WebSocket("ws://localhost:3000");e.onopen=()=>{console.log("==> Connected to WebSocket server")},e.onclose=()=>{console.log("==> Disconnected from WebSocket server")},e.onmessage=e=>{const t=JSON.parse(e.data);console.log("==> Received:",t)},document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("nickname-modal"),t=document.getElementById("nickname-input"),n=document.getElementById("nickname-submit"),o=document.getElementById("clear-history");n.addEventListener("click",(()=>{const n=t.value.trim();n?async function(t){try{const n=await fetch("http://localhost:3000/new-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})}),s=await n.json();"ok"===s.status?(console.log("==> Никнейм принят:",s.user.name),e.style.display="none",function(e){const t=document.getElementById("chat-container"),n=document.getElementById("message-input"),s=document.getElementById("send-message"),a=document.getElementById("messages"),r=document.getElementById("users");t.style.display="flex";const c=new WebSocket("ws://localhost:3000");function i(){const t=n.value.trim();if(t){const o={type:"send",message:t,user:{name:e},timestamp:(new Date).toISOString()};c.send(JSON.stringify(o)),d({...o,user:{name:"You"}}),n.value=""}}function d(e){const t=document.createElement("div");t.className="You"===e.user.name?"my-message":"other-message";const n=document.createElement("div");n.className="message-meta";const o=new Date(e.timestamp||Date.now()),s=o.toLocaleDateString(),r=o.toLocaleTimeString();n.innerHTML=`<strong>${e.user.name}:</strong> <span class="timestamp">${s} ${r}</span>`;const c=document.createElement("div");c.className="message-text",c.textContent=e.message,t.appendChild(n),t.appendChild(c),a.appendChild(t),a.scrollTop=a.scrollHeight}function m(t){r.innerHTML="",t.forEach((t=>{const n=document.createElement("li");n.textContent=t.name===e?"You":t.name,t.name===e&&n.classList.add("current-user"),r.appendChild(n)}))}c.onopen=()=>{c.send(JSON.stringify({type:"join",user:{name:e}}))},c.onmessage=t=>{const n=JSON.parse(t.data);if(Array.isArray(n)){m(n.filter((e=>""!==e.name)))}else"send"===n.type?n.user.name!==e&&d(n):"history"===n.type&&(a.innerHTML="",n.data.forEach((e=>d(e))))},n.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),i())})),s.addEventListener("click",i),o.addEventListener("click",(()=>{c.send(JSON.stringify({type:"clear"})),a.innerHTML=""})),window.addEventListener("beforeunload",(()=>{c.send(JSON.stringify({type:"exit",user:{name:e}})),c.close()}))}(t)):alert(s.message)}catch(e){console.error("Ошибка при проверке никнейма:",e)}}(n):alert("Пожалуйста, введите псевдоним.")}))}))}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";n(25)}()}();
//# sourceMappingURL=bundle.js.map